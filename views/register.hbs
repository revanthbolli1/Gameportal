<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Register</title>
    <link rel="stylesheet" href="/styles/login-register.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" integrity="sha512-CJ8DjKX9vijLLt3eBt2Gd+EgOdTtCvz0ZsRgiZPb8+vx9XZvAaOJ7x+c0TR8Ww7LOjvJr/aEL7CC91+nwn/VA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script src="https://kit.fontawesome.com/9bb6241c8c.js" defer crossorigin="anonymous"></script>
    <script src="/scripts/validate.js" defer></script>
    <link rel="shortcut icon" href="/images/title.png" type="image/icon">
    <link rel="stylesheet" href="/styles/nav.css">
</head>
<body>
    <div id="navbar">
        <nav>
            <i class="fa-solid fa-gamepad"></i>
            <h2>Gamezone</h2>
            <ul>
                <li><a href="/login">Login</a></li>
            </ul>
        </nav>
    </div>

    <section>
        <div class="register">
            <h2>Register</h2>
            <form action="/register" method="POST">
                <div class="control">
                    <input class="input" type="text" placeholder="Player Name*" name="playername">
                    <span class="error"></span>
                </div>
                <div class="control">
                    <input class="input" type="text" placeholder="Email*" name="email">
                    <span class="error"></span>
                </div>
                <div class="control">
                    <input class="input" type="password" placeholder="Password*" name="password">
                    <span class="error"></span>
                </div>
                <div class="control">
                    <input class="input" type="password" placeholder="Confirm Password*" name="cpassword">
                    <span class="error"></span>
                </div>
                <button type="submit">Register</button>
                <span class="message">{{msg}}</span>
            </form>
            <p>Already have an account?<a href="./login"> Login</a></p>
        </div>
    </section>
    <script>
    if (data.message==="Signup successfully") {
      // if signup was successful, redirect to login page
      window.location.href = 'http://localhost:8000/login';
    } 

function handleFormSubmit(event) {
    event.preventDefault(); // prevent the form from submitting
    // get the form data
    const formData = new FormData(event.target);
    const playerName = formData.get('playername');
    const email = formData.get('email');
    const password = formData.get('password');
    const cpassword = formData.get('cpassword');
    if(password!== cpassword)
    alert("password doesnot match")
    let input= {"playerName":playerName, "email":email, "password":password}
    // print the form data to the console
    console.log('Player Name:', playerName);
    console.log('Email:', email);
    console.log('Password:', password);
    console.log('Confirm Password:', cpassword);
    console.log(formData)
    // make a fetch request to the backend with the form data
    console.log(input)
    fetch('/register', {
      method: 'POST',
      headers: {
      'Content-Type': 'application/json'
    },
      body: JSON.stringify(input)
    })
    .then(response => response.json())
.then(data => { alert(data.message)
if (data.message==="Signup successfully") {
      // if signup was successful, redirect to login page
      window.location.href = 'http://localhost:8000/login';
    } })
      .catch(error => {
        console.error(error);
      });
  }

   </script> 
</body>
</html>